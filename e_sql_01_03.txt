
テキスト：達人に学ぶSQL徹底指南書 ～初級者で終わりたくないあなたへ～
日付：2月14日
作成者：玉利

問題番号：演習問題1-③ORDER BYでソート列を作る
内容：
 最後に考えてもらう問題は、ちょっと小手先のテクニックに属するものですが、時として使う必要に迫られることがあるので紹介しておきます。
 演習問題1-①で利用したGreatestsテーブルに対して、普通に「SELECT key FROM Greatests ORDER BY key;」(keyでテーブルを作成したところエラーが出たのでkeyをidに変更しています)というクエリを実行すると、key列をアルファベット順にソートした形で結果が表示されます。
 では問題です。その表示結果を、「B-A-C-D」の順番に並び替えるクエリを考えてください。この順番に特に規則性はありません。できたらほかの適当な順番でも試してみてください。

---回答---
実行文

SELECT                         -- id列を特定の手順で並び替えたものを表示するための命令文
      id                       -- idのみを取り出したいのでidを取り出す
FROM                           -- id列を所持しているGreatestsテーブルを指定する
      Greatests                -- Greatestsテーブルを指定する
ORDER BY                       -- 並び替えの順番を指定したいので並び替えを行う
CASE id  WHEN 'A' THEN 'B'     -- 降順でも昇順でもないのでCASE文によって条件分岐を行う
         WHEN 'B' THEN 'A'     -- BACDの順にしたいのでBの時はAに入れ替える
         WHEN 'C' THEN 'D'     -- BACDの順にしたいのでCの時はDに入れ替える
         WHEN 'D' THEN 'C'     -- BACDの順にしたいのでDの時はCに入れ替える
         ELSE NULL END         -- それ以外の時は特に何も指定を行わない
;                              -- 命令文を終了させる

実行結果

+----+
| id |
+----+
| B  |
| A  |
| D  |
| C  |
+----+
